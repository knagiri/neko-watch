# neko-watch 要件定義書

## 概要
ターミナルで動作する猫育成ゲーム。ASCIIアートで表現された猫を世話して育てる。

## 基本仕様

### ステータスパラメータ
- **空腹度**: 0-100（100が満腹）
- **幸福度**: 0-100（100が最高に幸せ）
- **清潔度**: 0-100（100が清潔）
- **健康度**: 0-100（100が健康）

### 基本アクション
1. **餌をあげる**: 空腹度+40、幸福度+10、清潔度-10（食べこぼし）
2. **遊ぶ**: 幸福度+25、空腹度-15（運動でお腹が空く）、清潔度-5
3. **お風呂/掃除**: 清潔度+60、幸福度-30（猫は水が大嫌い！）、健康度-10（ストレス）
4. **寝かせる**: 健康度を(空腹度+幸福度+清潔度)/4に設定、10分間アクション不可

### 時間経過による変化（難易度：30分でお世話必須）
- 各ステータスは時間経過で徐々に減少
- 減少速度（1分あたり）：
  - 空腹度: -2.5/分（40分で危険域）
  - 幸福度: -2/分（50分で0）
  - 清潔度: -1/分（100分で0）
  - 健康度: -2/分（通常）、-4/分（他のステータスが30未満の場合）

### 画面構成
```
==================== neko-watch ====================
名前: [猫の名前]

    [猫のASCIIアート]

コマンド:
[1] 餌をあげる  [2] 遊ぶ  [3] お風呂  [4] 寝かせる  [q] 終了
====================================================
```

ステータスは内部パラメータとして保持し、表示しない。
```
ステータス:
空腹度: ████████░░ 80/100
幸福度: ██████░░░░ 60/100
清潔度: █████████░ 90/100
健康度: ███████░░░ 70/100
```

### データ保存
- 初期バージョンでは実装しない
- アプリ起動時に新規スタート

## 猫表現仕様

### 表現領域定義
猫は6行×18文字の固定領域で表現される：
```
行1: 頭部 (耳)          ← 18文字固定
行2: 顔部 (目・鼻)      ← 18文字固定  
行3: 首輪               ← 18文字固定
行4: 前足・胴体         ← 18文字固定
行5: 後足・尻尾         ← 18文字固定
行6: 効果・メッセージ   ← 18文字固定 (状態により表示)
```

### 基本姿勢パターン
- **座り姿勢**: 基本姿勢（全ての表現はこの姿勢ベース）

### 表情パターン（猫らしい表現）

#### 目の表現パターン
- `o.o` - **通常**: 基本的な丸い目
- `^.^` - **幸せ**: 細くなった満足の目
- `-.o` / `o.-` - **まばたき**: 自然なアニメーション
- `-.-` / `_._` - **眠い**: 眠そうな半開きの目
- `@.@` - **ぼんやり**: 焦点が合わない、体調不良
- `x.x` - **気絶/重病**: 完全に目を閉じた状態
- `>.<` - **困惑**: 目を細めて困った表情

#### 尻尾の表現パターン
- `/)` `/ /` `/_/` - **通常**: リラックスした尻尾

### 効果・メッセージパターン
- **音符**: `♪`(楽しい), `♪♪`(とても楽しい)
- **汗**: `;;`～`;;;;;`(汚れ・困惑の段階表現)
- **疲労睡眠**: `Zzz`, `zZz`, `zzZ`, `ZzZ`(疲労状態のアニメーション)
- **深い睡眠**: `Zzz...`, `zzZ...`, `ZZZ...`, `zzz...`(睡眠中のアニメーション)
- **メッセージ**: `おなかすいた...`, `グゥ～`, `ぐったり`, `ムスッ`, `ごちそうさま♪`, `...`(瀕死)

### 状態定義と表現（優先順位順）

#### 1. 瀕死（いずれかのステータスが10未満）
- 目: `( x.x )`
- エフェクト: 行3右側に「...」
- 色: 赤

#### 2. 病気（健康度 < 20）
- 目: `( @.@ )` ↔ `( x.x )`（アニメーション）
- エフェクト: 行3右側に「ぐったり」

#### 3. 空腹（空腹度 < 30）
- 目: `( >.< )`
- エフェクト: 行3右側に「おなかすいた...」「グゥ～」（交互）

#### 4. 不潔（清潔度 < 30）
- 目: `( >.< )`
- エフェクト: 行3右側に `;;` → `;;;` → `;;;;` → `;;;;;`（アニメーション）

#### 5. 不機嫌（幸福度 < 30）
- 目: `( -.~ )`（片目つむり）
- エフェクト: 行3右側に「ムスッ」

#### 6. 疲労（健康度 < 50 かつ 幸福度 < 50）
- 目: `( -.- )` ↔ `( _._ )`（アニメーション）
- エフェクト: 行4右側に `Zzz` → `zZz` → `zzZ` → `ZzZ`（アニメーション）

#### 7. 上機嫌（幸福度 > 80）
- 目: `( ^.^ )`
- エフェクト: 行3右側に `♪` → `♪♪`（アニメーション）

#### 8. 満腹（空腹度 > 90 かつ 餌やり直後30秒）
- 目: `( ^ω^ )`
- エフェクト: 行3右側に「ごちそうさま♪」

#### 9. 普通（上記のどれにも該当しない）
- 目: `( o.o )` → `( -.o )` → `( o.- )`（まばたきアニメーション）
- エフェクト: なし

#### 10. 睡眠中（寝かせるアクション実行後10分間）
- 目: `( -.z )` → `( z.- )` → `( z.z )` → `( -.z )`（睡眠アニメーション）
- エフェクト: 行6に「Zzz...」「zzZ...」「ZZZ...」「zzz...」（アニメーション）
- 色: 青
- 優先度: 全状態より優先（瀕死状態でも睡眠中なら睡眠表示）

### 現在実装済み姿勢

#### 座り姿勢（基本形）
```
   /\_/\          
  ( o.o )         
   > ^ <     /)   
  /|   |\   / /   
 ( |___| ) /_/    
                  
```

**構成要素:**
- 行1: `/\_/\` - 猫の耳
- 行2: `( o.o )` - 目と顔の輪郭
- 行3: `> ^ <` - 首輪
- 行4: `/|   |\` - 前足、`/)` と `/ /` - 尻尾
- 行5: `( |___| )` - 胴体と後足、`/_/` - 尻尾先端
- 行6: (空白) - エフェクト表示領域

**特徴:**
- 18文字固定幅で中央揃え
- 右側に自然にカーブした尻尾
- 前足が明確に表現された座り姿勢
- 表情変更可能（目・口の部分）
- 効果追加可能（各行末尾や6行目）

## 技術要件
- 言語: Rust
- ターミナルUI: ratatui（crossterm backend）
- データ保存: JSON形式（serde_json）
- 主要クレート:
  - ratatui: TUIフレームワーク
  - crossterm: クロスプラットフォームターミナル操作
  - serde/serde_json: シリアライズ・デシリアライズ
  - chrono: 時刻処理
  - dirs: ユーザーディレクトリ取得

## 今後の拡張可能性
- データ保存機能（セーブ/ロード）
- 成長要素（子猫→成猫）
- アイテムシステム
- ミニゲーム
- 複数の猫を同時に育成
